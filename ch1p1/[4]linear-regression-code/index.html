<!doctype html>
<html class="docs-version-current" lang="zh-cn" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.9">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.20/dist/katex.min.css" crossorigin="anonymous"><title data-react-helmet="true">çº¿æ€§å›å½’ä»£ç å®ç° | å·¥å…·ç®±çš„æ·±åº¦å­¦ä¹ è®°äº‹ç°¿</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://ml.akasaki.space//ch1p1/[4]linear-regression-code"><meta data-react-helmet="true" name="docusaurus_locale" content="zh-cn"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-docs-current"><meta data-react-helmet="true" property="og:title" content="çº¿æ€§å›å½’ä»£ç å®ç° | å·¥å…·ç®±çš„æ·±åº¦å­¦ä¹ è®°äº‹ç°¿"><meta data-react-helmet="true" name="description" content="åœ¨äº†è§£äº†çº¿æ€§å›å½’çš„èƒŒæ™¯çŸ¥è¯†ä¹‹åï¼Œç°åœ¨æˆ‘ä»¬å¯ä»¥åŠ¨æ‰‹å®ç°å®ƒäº†ã€‚å°½ç®¡å¼ºå¤§çš„æ·±åº¦å­¦ä¹ æ¡†æ¶å¯ä»¥å‡å°‘å¤§é‡é‡å¤æ€§å·¥ä½œï¼Œä½†è‹¥è¿‡äºä¾èµ–å®ƒæä¾›çš„ä¾¿åˆ©ï¼Œä¼šå¯¼è‡´æˆ‘ä»¬å¾ˆéš¾æ·±å…¥ç†è§£æ·±åº¦å­¦ä¹ æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚å› æ­¤ï¼Œæœ¬èŠ‚å°†ä»‹ç»å¦‚ä½•åªåˆ©ç”¨Tensorå’ŒGradientTapeæ¥å®ç°ä¸€ä¸ªçº¿æ€§å›å½’çš„è®­ç»ƒã€‚"><meta data-react-helmet="true" property="og:description" content="åœ¨äº†è§£äº†çº¿æ€§å›å½’çš„èƒŒæ™¯çŸ¥è¯†ä¹‹åï¼Œç°åœ¨æˆ‘ä»¬å¯ä»¥åŠ¨æ‰‹å®ç°å®ƒäº†ã€‚å°½ç®¡å¼ºå¤§çš„æ·±åº¦å­¦ä¹ æ¡†æ¶å¯ä»¥å‡å°‘å¤§é‡é‡å¤æ€§å·¥ä½œï¼Œä½†è‹¥è¿‡äºä¾èµ–å®ƒæä¾›çš„ä¾¿åˆ©ï¼Œä¼šå¯¼è‡´æˆ‘ä»¬å¾ˆéš¾æ·±å…¥ç†è§£æ·±åº¦å­¦ä¹ æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚å› æ­¤ï¼Œæœ¬èŠ‚å°†ä»‹ç»å¦‚ä½•åªåˆ©ç”¨Tensorå’ŒGradientTapeæ¥å®ç°ä¸€ä¸ªçº¿æ€§å›å½’çš„è®­ç»ƒã€‚"><link data-react-helmet="true" rel="shortcut icon" href="/img/logo.svg"><link data-react-helmet="true" rel="canonical" href="https://ml.akasaki.space//ch1p1/[4]linear-regression-code"><link data-react-helmet="true" rel="alternate" href="https://ml.akasaki.space//ch1p1/[4]linear-regression-code" hreflang="zh-cn"><link data-react-helmet="true" rel="alternate" href="https://ml.akasaki.space//ch1p1/[4]linear-regression-code" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.54fd31ab.css">
<link rel="preload" href="/assets/js/runtime~main.e23c63c0.js" as="script">
<link rel="preload" href="/assets/js/main.f6709b37.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Logo" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/img/logo.svg" alt="Logo" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title">å·¥å…·ç®±çš„æ·±åº¦å­¦ä¹ è®°äº‹ç°¿</b></a><a class="navbar__item navbar__link" href="/unlimited-paper-works/">é­”æ³•éƒ¨æ—¥å¿—</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/neet-cv/ml.akasaki.space" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_iYfV toggle_2i4l toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">ğŸŒœ</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">ğŸŒ</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/">é¦–é¡µ</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">ç¬¬é›¶ç« ï¼šåœ¨å¼€å§‹ä¹‹å‰</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">ç¬¬ä¸€ç« ä¸Šï¼šHelloWorld</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ch1p1/[1]operate-on-data">æ•°æ®æ“ä½œ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ch1p1/[2]automatic-gradient">è‡ªåŠ¨æ±‚æ¢¯åº¦</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ch1p1/[3]linear-regression">çº¿æ€§å›å½’</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/ch1p1/[4]linear-regression-code">çº¿æ€§å›å½’ä»£ç å®ç°</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ch1p1/[5]softmax-regression">softmaxå›å½’</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ch1p1/[6]softmax-regression-code">softmaxå›å½’çš„ä»£ç å®ç°</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">ç¬¬ä¸€ç« ä¸‹ï¼šæ·±åº¦å­¦ä¹ åŸºç¡€</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">ç¬¬äºŒç« ä¸Šï¼šå·ç§¯ç¥ç»ç½‘ç»œ</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">ç¬¬äºŒç« ä¸‹ï¼šç»å…¸å·ç§¯ç¥ç»ç½‘ç»œ</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">ç¬¬ä¸‰ç« ä¸Šï¼šè°ˆä¸€äº›è®¡ç®—æœºè§†è§‰æ–¹å‘</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">ç¬¬ä¸‰ç« ä¸‹ï¼šäº†è§£æ›´é«˜çº§çš„æŠ€æœ¯</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">é™„å½•1ï¼šå¥½æœ‹å‹ä»¬</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">é™„å½•2ï¼šæ•°å­¦æ˜¯çœŸæ­£çš„åœ£ç»</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">é™„å½•3ï¼šä¿¡å·å’Œé‡‡æ ·çš„å­¦é—®ï¼ˆDSPï¼‰</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">é™„å½•4ï¼šTensorFlowç¼–ç¨‹ç­–ç•¥</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/unlimited-paper-works/">é­”æ³•éƒ¨æ—¥å¿—ï¼ˆåˆåè®ºæ–‡é˜…è¯»æ—¥å¿—ï¼‰</a></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_eoK2"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_e+kA"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>çº¿æ€§å›å½’ä»£ç å®ç°</h1></header><p>åœ¨äº†è§£äº†çº¿æ€§å›å½’çš„èƒŒæ™¯çŸ¥è¯†ä¹‹åï¼Œç°åœ¨æˆ‘ä»¬å¯ä»¥åŠ¨æ‰‹å®ç°å®ƒäº†ã€‚å°½ç®¡å¼ºå¤§çš„æ·±åº¦å­¦ä¹ æ¡†æ¶å¯ä»¥å‡å°‘å¤§é‡é‡å¤æ€§å·¥ä½œï¼Œä½†è‹¥è¿‡äºä¾èµ–å®ƒæä¾›çš„ä¾¿åˆ©ï¼Œä¼šå¯¼è‡´æˆ‘ä»¬å¾ˆéš¾æ·±å…¥ç†è§£æ·±åº¦å­¦ä¹ æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚å› æ­¤ï¼Œæœ¬èŠ‚å°†ä»‹ç»å¦‚ä½•åªåˆ©ç”¨<code>Tensor</code>å’Œ<code>GradientTape</code>æ¥å®ç°ä¸€ä¸ªçº¿æ€§å›å½’çš„è®­ç»ƒã€‚</p><p>é¦–å…ˆï¼Œå¯¼å…¥æœ¬èŠ‚ä¸­å®éªŒæ‰€éœ€çš„åŒ…æˆ–æ¨¡å—ï¼Œå…¶ä¸­çš„matplotlibåŒ…å¯ç”¨äºä½œå›¾ï¼Œä¸”è®¾ç½®æˆåµŒå…¥æ˜¾ç¤ºã€‚</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token operator" style="color:#393A34">%</span><span class="token plain">matplotlib inline</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> tensorflow </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> tf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">__version__</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> matplotlib </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> pyplot </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> plt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> random</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">    2.0.0</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="æ‰‹åŠ¨å®ç°">æ‰‹åŠ¨å®ç°<a aria-hidden="true" class="hash-link" href="#æ‰‹åŠ¨å®ç°" title="Direct link to heading">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_y2LR" id="ç”Ÿæˆæ•°æ®é›†">ç”Ÿæˆæ•°æ®é›†<a aria-hidden="true" class="hash-link" href="#ç”Ÿæˆæ•°æ®é›†" title="Direct link to heading">â€‹</a></h3><p>æˆ‘ä»¬æ„é€ ä¸€ä¸ªç®€å•çš„äººå·¥è®­ç»ƒæ•°æ®é›†ï¼Œå®ƒå¯ä»¥ä½¿æˆ‘ä»¬èƒ½å¤Ÿç›´è§‚æ¯”è¾ƒå­¦åˆ°çš„å‚æ•°å’ŒçœŸå®çš„æ¨¡å‹å‚æ•°çš„åŒºåˆ«ã€‚è®¾è®­ç»ƒæ•°æ®é›†æ ·æœ¬æ•°ä¸º1000ï¼Œè¾“å…¥ä¸ªæ•°ï¼ˆç‰¹å¾æ•°ï¼‰ä¸º2ã€‚ç»™å®šéšæœºç”Ÿæˆçš„æ‰¹é‡æ ·æœ¬ç‰¹å¾ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold-italic">X</mi><mo>âˆˆ</mo><msup><mi mathvariant="double-struck">R</mi><mrow><mn>1000</mn><mo>Ã—</mo><mn>2</mn></mrow></msup></mrow><annotation encoding="application/x-tex">\boldsymbol{X} \in \mathbb{R}^{1000 \times 2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7252em;vertical-align:-0.0391em"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.07778em">X</span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">âˆˆ</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8141em"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1000</span><span class="mbin mtight">Ã—</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></span>ï¼Œæˆ‘ä»¬ä½¿ç”¨çº¿æ€§å›å½’æ¨¡å‹çœŸå®æƒé‡ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold-italic">w</mi><mo>=</mo><mo stretchy="false">[</mo><mn>2</mn><mo separator="true">,</mo><mo>âˆ’</mo><mn>3.4</mn><msup><mo stretchy="false">]</mo><mi mathvariant="normal">âŠ¤</mi></msup></mrow><annotation encoding="application/x-tex">\boldsymbol{w} = [2, -3.4]^\top</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4444em"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.02778em">w</span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.0991em;vertical-align:-0.25em"></span><span class="mopen">[</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">âˆ’</span><span class="mord">3.4</span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">âŠ¤</span></span></span></span></span></span></span></span></span></span></span></span> å’Œåå·® <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mo>=</mo><mn>4.2</mn></mrow><annotation encoding="application/x-tex">b = 4.2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">4.2</span></span></span></span></span>ï¼Œä»¥åŠä¸€ä¸ªéšæœºå™ªå£°é¡¹ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Ïµ</mi></mrow><annotation encoding="application/x-tex">\epsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">Ïµ</span></span></span></span></span> æ¥ç”Ÿæˆæ ‡ç­¾</p><div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="bold-italic">y</mi><mo>=</mo><mi mathvariant="bold-italic">X</mi><mi mathvariant="bold-italic">w</mi><mo>+</mo><mi>b</mi><mo>+</mo><mi>Ïµ</mi></mrow><annotation encoding="application/x-tex">\boldsymbol{y} = \boldsymbol{X}\boldsymbol{w} + b + \epsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.1944em"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em">y</span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.7694em;vertical-align:-0.0833em"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.07778em">X</span></span></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.02778em">w</span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">Ïµ</span></span></span></span></span></div><p>å…¶ä¸­å™ªå£°é¡¹ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Ïµ</mi></mrow><annotation encoding="application/x-tex">\epsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">Ïµ</span></span></span></span></span> æœä»å‡å€¼ä¸º0ã€æ ‡å‡†å·®ä¸º0.01çš„æ­£æ€åˆ†å¸ƒã€‚å™ªå£°ä»£è¡¨äº†æ•°æ®é›†ä¸­æ— æ„ä¹‰çš„å¹²æ‰°ã€‚ä¸‹é¢ï¼Œè®©æˆ‘ä»¬ç”Ÿæˆæ•°æ®é›†ã€‚</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">num_inputs </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">num_examples </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">true_w </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">3.4</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">true_b </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4.2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">features </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> tf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">random</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">normal</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">num_examples</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> num_inputs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">stddev </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">labels </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> true_w</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> features</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> true_w</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> features</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> true_b</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">labels </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> tf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">random</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">normal</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">labels</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">shape</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">stddev</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0.01</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>æ³¨æ„ï¼Œ<code>features</code>çš„æ¯ä¸€è¡Œæ˜¯ä¸€ä¸ªé•¿åº¦ä¸º2çš„å‘é‡ï¼Œè€Œ<code>labels</code>çš„æ¯ä¸€è¡Œæ˜¯ä¸€ä¸ªé•¿åº¦ä¸º1çš„å‘é‡ï¼ˆæ ‡é‡ï¼‰ã€‚</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">features</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> labels</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>è¾“å‡ºï¼š</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">(&lt;tf.Tensor: id=31, shape=(2,), dtype=float32, numpy=array([0.24220389, 0.41220406], dtype=float32)&gt;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> &lt;tf.Tensor: id=35, shape=(), dtype=float32, numpy=3.3064191&gt;)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>é€šè¿‡ç”Ÿæˆç¬¬äºŒä¸ªç‰¹å¾<code>features[:, 1]</code>å’Œæ ‡ç­¾ <code>labels</code> çš„æ•£ç‚¹å›¾ï¼Œå¯ä»¥æ›´ç›´è§‚åœ°è§‚å¯Ÿä¸¤è€…é—´çš„çº¿æ€§å…³ç³»ã€‚</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">set_figsize</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">figsize</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">3.5</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2.5</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    plt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">rcParams</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;figure.figsize&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> figsize</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">set_figsize</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">plt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">scatter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">features</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> labels</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p><img alt="img" src="/assets/images/3.2_output1-4f4d9df305a4f5ef78109cab7db87adc.png"></p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="è¯»å–æ•°æ®">è¯»å–æ•°æ®<a aria-hidden="true" class="hash-link" href="#è¯»å–æ•°æ®" title="Direct link to heading">â€‹</a></h3><p>åœ¨è®­ç»ƒæ¨¡å‹çš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦éå†æ•°æ®é›†å¹¶ä¸æ–­è¯»å–å°æ‰¹é‡æ•°æ®æ ·æœ¬ã€‚è¿™é‡Œæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼šå®ƒæ¯æ¬¡è¿”å›<code>batch_size</code>ï¼ˆæ‰¹é‡å¤§å°ï¼‰ä¸ªéšæœºæ ·æœ¬çš„ç‰¹å¾å’Œæ ‡ç­¾ã€‚</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">data_iter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">batch_size</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> features</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> labels</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    num_examples </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">len</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">features</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    indices </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">list</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">num_examples</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    random</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">shuffle</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">indices</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> i </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> num_examples</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> batch_size</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        j </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> indices</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">min</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i</span><span class="token operator" style="color:#393A34">+</span><span class="token plain">batch_size</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> num_examples</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">yield</span><span class="token plain"> tf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">gather</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">features</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> axis</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> indices</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">j</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> tf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">gather</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">labels</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> axis</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> indices</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">j</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>è®©æˆ‘ä»¬è¯»å–ç¬¬ä¸€ä¸ªå°æ‰¹é‡æ•°æ®æ ·æœ¬å¹¶æ‰“å°ã€‚æ¯ä¸ªæ‰¹é‡çš„ç‰¹å¾å½¢çŠ¶ä¸º(10, 2)ï¼Œåˆ†åˆ«å¯¹åº”æ‰¹é‡å¤§å°å’Œè¾“å…¥ä¸ªæ•°ï¼›æ ‡ç­¾å½¢çŠ¶ä¸ºæ‰¹é‡å¤§å°ã€‚</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">batch_size </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> X</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> y </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> data_iter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">batch_size</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> features</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> labels</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">X</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> y</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">break</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>è¾“å‡ºï¼š</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">tf.Tensor(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[[ 0.04718596 -1.5959413 ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> [ 0.3889716  -1.5288432 ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> [-1.8489572   1.66422   ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> [-1.3978077  -0.85818154]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> [-0.36940867 -0.619267  ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> [-0.15660426  1.1231796 ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> [ 0.89411694  1.5499148 ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> [ 1.9971682  -0.56981105]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> [-2.1852891   0.18805206]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> [ 1.3222371  -1.0301086 ]], shape=(10, 2), dtype=float32) tf.Tensor(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[ 9.738684   10.164594   -5.15065     4.3305573   5.568048    0.06494669</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  0.7251317  10.128626   -0.8036391  10.343082  ], shape=(10,), dtype=float32)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="åˆå§‹åŒ–æ¨¡å‹å‚æ•°">åˆå§‹åŒ–æ¨¡å‹å‚æ•°<a aria-hidden="true" class="hash-link" href="#åˆå§‹åŒ–æ¨¡å‹å‚æ•°" title="Direct link to heading">â€‹</a></h3><p>æˆ‘ä»¬å°†æƒé‡åˆå§‹åŒ–æˆå‡å€¼ä¸º0ã€æ ‡å‡†å·®ä¸º0.01çš„æ­£æ€éšæœºæ•°ï¼Œåå·®åˆ™åˆå§‹åŒ–æˆ0ã€‚</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">w </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> tf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Variable</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">random</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">normal</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">num_inputs</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> stddev</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0.01</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">b </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> tf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Variable</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">zeros</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="å®šä¹‰æ¨¡å‹">å®šä¹‰æ¨¡å‹<a aria-hidden="true" class="hash-link" href="#å®šä¹‰æ¨¡å‹" title="Direct link to heading">â€‹</a></h3><p>ä¸‹é¢æ˜¯çº¿æ€§å›å½’çš„çŸ¢é‡è®¡ç®—è¡¨è¾¾å¼çš„å®ç°ã€‚æˆ‘ä»¬ä½¿ç”¨<code>matmul</code>å‡½æ•°åšçŸ©é˜µä¹˜æ³•ã€‚</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">linreg</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">X</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> w</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> b</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> tf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">matmul</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">X</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> w</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> b</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="å®šä¹‰æŸå¤±å‡½æ•°">å®šä¹‰æŸå¤±å‡½æ•°<a aria-hidden="true" class="hash-link" href="#å®šä¹‰æŸå¤±å‡½æ•°" title="Direct link to heading">â€‹</a></h3><p>æˆ‘ä»¬ä½¿ç”¨ä¸Šä¸€èŠ‚æè¿°çš„å¹³æ–¹æŸå¤±æ¥å®šä¹‰çº¿æ€§å›å½’çš„æŸå¤±å‡½æ•°ã€‚åœ¨å®ç°ä¸­ï¼Œæˆ‘ä»¬éœ€è¦æŠŠçœŸå®å€¼<code>y</code>å˜å½¢æˆé¢„æµ‹å€¼<code>y_hat</code>çš„å½¢çŠ¶ã€‚ä»¥ä¸‹å‡½æ•°è¿”å›çš„ç»“æœä¹Ÿå°†å’Œ<code>y_hat</code>çš„å½¢çŠ¶ç›¸åŒã€‚</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">squared_loss</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">y_hat</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> y</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">y_hat </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> tf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">reshape</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">y</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> y_hat</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">shape</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">**</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">2</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="å®šä¹‰ä¼˜åŒ–ç®—æ³•">å®šä¹‰ä¼˜åŒ–ç®—æ³•<a aria-hidden="true" class="hash-link" href="#å®šä¹‰ä¼˜åŒ–ç®—æ³•" title="Direct link to heading">â€‹</a></h3><p>ä»¥ä¸‹çš„<code>sgd</code>å‡½æ•°å®ç°äº†ä¸Šä¸€èŠ‚ä¸­ä»‹ç»çš„å°æ‰¹é‡éšæœºæ¢¯åº¦ä¸‹é™ç®—æ³•ã€‚å®ƒé€šè¿‡ä¸æ–­è¿­ä»£æ¨¡å‹å‚æ•°æ¥ä¼˜åŒ–æŸå¤±å‡½æ•°ã€‚è¿™é‡Œè‡ªåŠ¨æ±‚æ¢¯åº¦æ¨¡å—è®¡ç®—å¾—æ¥çš„æ¢¯åº¦æ˜¯ä¸€ä¸ªæ‰¹é‡æ ·æœ¬çš„æ¢¯åº¦å’Œã€‚æˆ‘ä»¬å°†å®ƒé™¤ä»¥æ‰¹é‡å¤§å°æ¥å¾—åˆ°å¹³å‡å€¼ã€‚</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">sgd</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">params</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> lr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> batch_size</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> grads</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#e3116c">&quot;&quot;&quot;Mini-batch stochastic gradient descent.&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> i</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> param </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">enumerate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">params</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        param</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">assign_sub</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">lr </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> grads</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"> batch_size</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="è®­ç»ƒæ¨¡å‹">è®­ç»ƒæ¨¡å‹<a aria-hidden="true" class="hash-link" href="#è®­ç»ƒæ¨¡å‹" title="Direct link to heading">â€‹</a></h3><p>åœ¨è®­ç»ƒä¸­ï¼Œæˆ‘ä»¬å°†å¤šæ¬¡è¿­ä»£æ¨¡å‹å‚æ•°ã€‚åœ¨æ¯æ¬¡è¿­ä»£ä¸­ï¼Œæˆ‘ä»¬æ ¹æ®å½“å‰è¯»å–çš„å°æ‰¹é‡æ•°æ®æ ·æœ¬ï¼ˆç‰¹å¾<code>X</code>å’Œæ ‡ç­¾<code>y</code>ï¼‰ï¼Œé€šè¿‡è°ƒç”¨åå‘å‡½æ•°<code>t.gradients</code>è®¡ç®—å°æ‰¹é‡éšæœºæ¢¯åº¦ï¼Œå¹¶è°ƒç”¨ä¼˜åŒ–ç®—æ³•<code>sgd</code>è¿­ä»£æ¨¡å‹å‚æ•°ã€‚ç”±äºæˆ‘ä»¬ä¹‹å‰è®¾æ‰¹é‡å¤§å°<code>batch_size</code>ä¸º10ï¼Œæ¯ä¸ªå°æ‰¹é‡çš„æŸå¤±<code>l</code>çš„å½¢çŠ¶ä¸º(10, 1)ã€‚å›å¿†ä¸€ä¸‹è‡ªåŠ¨æ±‚æ¢¯åº¦ä¸€èŠ‚ã€‚ç”±äºå˜é‡<code>l</code>å¹¶ä¸æ˜¯ä¸€ä¸ªæ ‡é‡ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è°ƒç”¨<code>reduce_sum()</code>å°†å…¶æ±‚å’Œå¾—åˆ°ä¸€ä¸ªæ ‡é‡ï¼Œå†è¿è¡Œ<code>t.gradients</code>å¾—åˆ°è¯¥å˜é‡æœ‰å…³æ¨¡å‹å‚æ•°çš„æ¢¯åº¦ã€‚æ³¨æ„åœ¨æ¯æ¬¡æ›´æ–°å®Œå‚æ•°åä¸è¦å¿˜äº†å°†å‚æ•°çš„æ¢¯åº¦æ¸…é›¶ã€‚</p><p>åœ¨ä¸€ä¸ªè¿­ä»£å‘¨æœŸï¼ˆepochï¼‰ä¸­ï¼Œæˆ‘ä»¬å°†å®Œæ•´éå†ä¸€é<code>data_iter</code>å‡½æ•°ï¼Œå¹¶å¯¹è®­ç»ƒæ•°æ®é›†ä¸­æ‰€æœ‰æ ·æœ¬éƒ½ä½¿ç”¨ä¸€æ¬¡ï¼ˆå‡è®¾æ ·æœ¬æ•°èƒ½å¤Ÿè¢«æ‰¹é‡å¤§å°æ•´é™¤ï¼‰ã€‚è¿™é‡Œçš„è¿­ä»£å‘¨æœŸä¸ªæ•°<code>num_epochs</code>å’Œå­¦ä¹ ç‡<code>lr</code>éƒ½æ˜¯è¶…å‚æ•°ï¼Œåˆ†åˆ«è®¾3å’Œ0.03ã€‚åœ¨å®è·µä¸­ï¼Œå¤§å¤šè¶…å‚æ•°éƒ½éœ€è¦é€šè¿‡åå¤è¯•é”™æ¥ä¸æ–­è°ƒèŠ‚ã€‚è™½ç„¶è¿­ä»£å‘¨æœŸæ•°è®¾å¾—è¶Šå¤§æ¨¡å‹å¯èƒ½è¶Šæœ‰æ•ˆï¼Œä½†æ˜¯è®­ç»ƒæ—¶é—´å¯èƒ½è¿‡é•¿ã€‚è€Œæœ‰å…³å­¦ä¹ ç‡å¯¹æ¨¡å‹çš„å½±å“ï¼Œæˆ‘ä»¬ä¼šåœ¨åé¢â€œä¼˜åŒ–ç®—æ³•â€ä¸€ç« ä¸­è¯¦ç»†ä»‹ç»ã€‚</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">lr </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.03</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">num_epochs </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">net </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> linreg</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">loss </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> squared_loss</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> epoch </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">num_epochs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> X</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> y </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> data_iter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">batch_size</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> features</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> labels</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">with</span><span class="token plain"> tf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">GradientTape</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> t</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            t</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">watch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">w</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">b</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            l </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> tf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">reduce_sum</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">loss</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">net</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">X</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> w</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> b</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> y</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        grads </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> t</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">gradient</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">l</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">w</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> b</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        sgd</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">w</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> b</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> lr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> batch_size</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> grads</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    train_l </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> loss</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">net</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">features</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> w</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> b</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> labels</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;epoch %d, loss %f&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">%</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">epoch </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> tf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">reduce_mean</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">train_l</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>è¾“å‡ºï¼š</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain"> epoch 1, loss 0.028907 epoch 2, loss 0.000101 epoch 3, loss 0.000049</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>è®­ç»ƒå®Œæˆåï¼Œæˆ‘ä»¬å¯ä»¥æ¯”è¾ƒå­¦åˆ°çš„å‚æ•°å’Œç”¨æ¥ç”Ÿæˆè®­ç»ƒé›†çš„çœŸå®å‚æ•°ã€‚å®ƒä»¬åº”è¯¥å¾ˆæ¥è¿‘ã€‚</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">true_w</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> w</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">true_b</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> b</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>è¾“å‡ºï¼š</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">([2, -3.4], &lt;tf.Variable &#x27;Variable:0&#x27; shape=(2, 1) dtype=float32, numpy= array([[ 1.9994558], [-3.3993363]], dtype=float32)&gt;) (4.2, &lt;tf.Variable &#x27;Variable:0&#x27; shape=(1,) dtype=float32, numpy=array([4.199041], dtype=float32)&gt;)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="ä½¿ç”¨æ¡†æ¶å®ç°">ä½¿ç”¨æ¡†æ¶å®ç°<a aria-hidden="true" class="hash-link" href="#ä½¿ç”¨æ¡†æ¶å®ç°" title="Direct link to heading">â€‹</a></h2><p>éšç€æ·±åº¦å­¦ä¹ æ¡†æ¶çš„å‘å±•ï¼Œå¼€å‘æ·±åº¦å­¦ä¹ åº”ç”¨å˜å¾—è¶Šæ¥è¶Šä¾¿åˆ©ã€‚å®è·µä¸­ï¼Œæˆ‘ä»¬é€šå¸¸å¯ä»¥ç”¨æ¯”ä¸Šä¸€èŠ‚æ›´ç®€æ´çš„ä»£ç æ¥å®ç°åŒæ ·çš„æ¨¡å‹ã€‚åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†ä»‹ç»å¦‚ä½•ä½¿ç”¨tensorflow2.0æ¨èçš„kerasæ¥å£æ›´æ–¹ä¾¿åœ°å®ç°çº¿æ€§å›å½’çš„è®­ç»ƒã€‚</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="ç”Ÿæˆæ•°æ®é›†-1">ç”Ÿæˆæ•°æ®é›†<a aria-hidden="true" class="hash-link" href="#ç”Ÿæˆæ•°æ®é›†-1" title="Direct link to heading">â€‹</a></h3><p>æˆ‘ä»¬ç”Ÿæˆä¸ä¸Šä¸€èŠ‚ä¸­ç›¸åŒçš„æ•°æ®é›†ã€‚å…¶ä¸­<code>features</code>æ˜¯è®­ç»ƒæ•°æ®ç‰¹å¾ï¼Œ<code>labels</code>æ˜¯æ ‡ç­¾ã€‚</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> tensorflow </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> tf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">num_inputs </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">num_examples </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">true_w </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">3.4</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">true_b </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4.2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">features </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> tf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">random</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">normal</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">shape</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">num_examples</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> num_inputs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> stddev</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">labels </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> true_w</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> features</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> true_w</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> features</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> true_b</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">labels </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> tf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">random</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">normal</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">labels</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">shape</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> stddev</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0.01</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="è¯»å–æ•°æ®-1">è¯»å–æ•°æ®<a aria-hidden="true" class="hash-link" href="#è¯»å–æ•°æ®-1" title="Direct link to heading">â€‹</a></h3><p>è™½ç„¶tensorflow2.0å¯¹äºçº¿æ€§å›å½’å¯ä»¥ç›´æ¥æ‹Ÿåˆï¼Œä¸ç”¨å†åˆ’åˆ†æ•°æ®é›†ï¼Œä½†æˆ‘ä»¬ä»å­¦ä¹ ä¸€ä¸‹è¯»å–æ•°æ®çš„æ–¹æ³•</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> tensorflow </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> data </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> tfdata</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">batch_size </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># å°†è®­ç»ƒæ•°æ®çš„ç‰¹å¾å’Œæ ‡ç­¾ç»„åˆ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dataset </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> tfdata</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Dataset</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">from_tensor_slices</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">features</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> labels</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># éšæœºè¯»å–å°æ‰¹é‡</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dataset </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> dataset</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">shuffle</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">buffer_size</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">num_examples</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dataset </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> dataset</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">batch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">batch_size</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">data_iter </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">iter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">dataset</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p><code>shuffle</code> çš„ <code>buffer_size</code> å‚æ•°åº”å¤§äºç­‰äºæ ·æœ¬æ•°ï¼Œ<code>batch</code> å¯ä»¥æŒ‡å®š <code>batch_size</code> çš„åˆ†å‰²å¤§å°ã€‚</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> X</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> y </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> data_iter</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">X</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> y</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">break</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">tf.Tensor(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[[ 1.2856768   1.3815335 ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> [ 1.1151928  -1.3777982 ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> [ 0.6097271   1.3478378 ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> [ 2.1615875   1.52963   ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> [-1.3143488  -0.79531455]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> [-2.495006    0.3701927 ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> [-0.07739297 -0.8636043 ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> [-0.18479416 -1.5275241 ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> [-0.3426277  -0.01935842]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> [ 0.25231913  1.4940815 ]], shape=(10, 2), dtype=float32) tf.Tensor(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[ 2.0673854  11.10116     0.8320709   3.3300133   4.272185   -2.062947</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  6.981174    9.027803    3.5848885  -0.39152586], shape=(10,),     dtype=float32)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>ä½¿ç”¨<code>iter(dataset)</code>çš„æ–¹å¼ï¼Œåªèƒ½éå†æ•°æ®é›†ä¸€æ¬¡ï¼Œæ˜¯ä¸€ç§æ¯”è¾ƒ tricky çš„å†™æ³•ï¼Œä¸ºäº†å¤åˆ»åŸä¹¦è¡¨è¾¾æ‰è¿™æ ·å†™ã€‚è¿™é‡Œä¹Ÿç»™å‡ºä¸€ç§åœ¨<a href="https://www.tensorflow.org/guide/eager?hl=zh_cn#computing_gradients" target="_blank" rel="noopener noreferrer">å®˜æ–¹æ–‡æ¡£</a>ä¸­æ¨èçš„å†™æ³•ï¼š</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">batch</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">X</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> y</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">enumerate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">dataset</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">X</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> y</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">break</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="å®šä¹‰æ¨¡å‹å’Œåˆå§‹åŒ–å‚æ•°">å®šä¹‰æ¨¡å‹å’Œåˆå§‹åŒ–å‚æ•°<a aria-hidden="true" class="hash-link" href="#å®šä¹‰æ¨¡å‹å’Œåˆå§‹åŒ–å‚æ•°" title="Direct link to heading">â€‹</a></h3><p><code>Tensorflow 2.0</code>æ¨èä½¿ç”¨<code>Keras</code>å®šä¹‰ç½‘ç»œï¼Œæ•…ä½¿ç”¨<code>Keras</code>å®šä¹‰ç½‘ç»œã€‚æˆ‘ä»¬å…ˆå®šä¹‰ä¸€ä¸ªæ¨¡å‹å˜é‡<code>model</code>ï¼Œå®ƒæ˜¯ä¸€ä¸ª<code>Sequential</code>å®ä¾‹ã€‚åœ¨<code>Keras</code>ä¸­ï¼Œ<code>Sequential</code>å®ä¾‹å¯ä»¥çœ‹ä½œæ˜¯ä¸€ä¸ªä¸²è”å„ä¸ªå±‚çš„å®¹å™¨ã€‚åœ¨æ„é€ æ¨¡å‹æ—¶ï¼Œæˆ‘ä»¬åœ¨è¯¥å®¹å™¨ä¸­ä¾æ¬¡æ·»åŠ å±‚ã€‚å½“ç»™å®šè¾“å…¥æ•°æ®æ—¶ï¼Œå®¹å™¨ä¸­çš„æ¯ä¸€å±‚å°†ä¾æ¬¡æ¨æ–­ä¸‹ä¸€å±‚çš„è¾“å…¥å°ºå¯¸ã€‚é‡è¦çš„ä¸€ç‚¹æ˜¯ï¼Œåœ¨<code>Keras</code>ä¸­æˆ‘ä»¬æ— é¡»æŒ‡å®šæ¯ä¸€å±‚è¾“å…¥çš„å½¢çŠ¶ã€‚çº¿æ€§å›å½’ï¼Œè¾“å…¥å±‚ä¸è¾“å‡ºå±‚ç­‰æ•ˆä¸ºä¸€å±‚å…¨è¿æ¥å±‚<code>keras.layers.Dense()</code>ã€‚</p><p><code>Keras</code> ä¸­åˆå§‹åŒ–å‚æ•°ç”± <code>kernel_initializer</code> å’Œ <code>bias_initializer</code> é€‰é¡¹åˆ†åˆ«è®¾ç½®æƒé‡å’Œåç½®çš„åˆå§‹åŒ–æ–¹å¼ã€‚æˆ‘ä»¬ä» <code>tensorflow</code> å¯¼å…¥ <code>initializers</code> æ¨¡å—ï¼ŒæŒ‡å®šæƒé‡å‚æ•°æ¯ä¸ªå…ƒç´ å°†åœ¨åˆå§‹åŒ–æ—¶éšæœºé‡‡æ ·äºå‡å€¼ä¸º0ã€æ ‡å‡†å·®ä¸º0.01çš„æ­£æ€åˆ†å¸ƒã€‚åå·®å‚æ•°é»˜è®¤ä¼šåˆå§‹åŒ–ä¸ºé›¶ã€‚<code>RandomNormal(stddev=0.01)</code>æŒ‡å®šæƒé‡å‚æ•°æ¯ä¸ªå…ƒç´ å°†åœ¨åˆå§‹åŒ–æ—¶éšæœºé‡‡æ ·äºå‡å€¼ä¸º0ã€æ ‡å‡†å·®ä¸º0.01çš„æ­£æ€åˆ†å¸ƒã€‚åå·®å‚æ•°é»˜è®¤ä¼šåˆå§‹åŒ–ä¸ºé›¶ã€‚</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> tensorflow </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> keras</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> tensorflow</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">keras </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> layers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> tensorflow </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> initializers </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> init</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">model </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> keras</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Sequential</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">model</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">add</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">layers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Dense</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> kernel_initializer</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">init</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">RandomNormal</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">stddev</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0.01</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="å®šä¹‰æŸå¤±å‡½æ•°-1">å®šä¹‰æŸå¤±å‡½æ•°<a aria-hidden="true" class="hash-link" href="#å®šä¹‰æŸå¤±å‡½æ•°-1" title="Direct link to heading">â€‹</a></h3><p><code>Tensoflow</code>åœ¨<code>losses</code>æ¨¡å—ä¸­æä¾›äº†å„ç§æŸå¤±å‡½æ•°å’Œè‡ªå®šä¹‰æŸå¤±å‡½æ•°çš„åŸºç±»ï¼Œå¹¶ç›´æ¥ä½¿ç”¨å®ƒçš„å‡æ–¹è¯¯å·®æŸå¤±ä½œä¸ºæ¨¡å‹çš„æŸå¤±å‡½æ•°ã€‚</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> tensorflow </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> losses</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">loss </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> losses</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">MeanSquaredError</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="å®šä¹‰ä¼˜åŒ–ç®—æ³•-1">å®šä¹‰ä¼˜åŒ–ç®—æ³•<a aria-hidden="true" class="hash-link" href="#å®šä¹‰ä¼˜åŒ–ç®—æ³•-1" title="Direct link to heading">â€‹</a></h3><p>åŒæ ·ï¼Œæˆ‘ä»¬ä¹Ÿæ— é¡»è‡ªå·±å®ç°å°æ‰¹é‡éšæœºæ¢¯åº¦ä¸‹é™ç®—æ³•ã€‚<code>tensorflow.keras.optimizers</code> æ¨¡å—æä¾›äº†å¾ˆå¤šå¸¸ç”¨çš„ä¼˜åŒ–ç®—æ³•æ¯”å¦‚SGDã€Adamå’ŒRMSPropç­‰ã€‚ä¸‹é¢æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªç”¨äºä¼˜åŒ–model æ‰€æœ‰å‚æ•°çš„ä¼˜åŒ–å™¨å®ä¾‹ï¼Œå¹¶æŒ‡å®šå­¦ä¹ ç‡ä¸º0.03çš„å°æ‰¹é‡éšæœºæ¢¯åº¦ä¸‹é™ï¼ˆSGDï¼‰ä¸ºä¼˜åŒ–ç®—æ³•ã€‚</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> tensorflow</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">keras </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> optimizers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">trainer </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> optimizers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">SGD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">learning_rate</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0.03</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="è®­ç»ƒæ¨¡å‹-1">è®­ç»ƒæ¨¡å‹<a aria-hidden="true" class="hash-link" href="#è®­ç»ƒæ¨¡å‹-1" title="Direct link to heading">â€‹</a></h3><p>åœ¨ä½¿ç”¨<code>Tensorflow</code>è®­ç»ƒæ¨¡å‹æ—¶ï¼Œæˆ‘ä»¬é€šè¿‡è°ƒç”¨<code>tensorflow.GradientTape</code>è®°å½•åŠ¨æ€å›¾æ¢¯åº¦ï¼Œæ‰§è¡Œ<code>tape.gradient</code>è·å¾—åŠ¨æ€å›¾ä¸­å„å˜é‡æ¢¯åº¦ã€‚é€šè¿‡ <code>model.trainable_variables</code> æ‰¾åˆ°éœ€è¦æ›´æ–°çš„å˜é‡ï¼Œå¹¶ç”¨ <code>trainer.apply_gradients</code> æ›´æ–°æƒé‡ï¼Œå®Œæˆä¸€æ­¥è®­ç»ƒã€‚</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">num_epochs </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> epoch </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> num_epochs </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">batch</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">X</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> y</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">enumerate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">dataset</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">with</span><span class="token plain"> tf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">GradientTape</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> tape</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            l </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> loss</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">model</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">X</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> training</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> y</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        grads </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> tape</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">gradient</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">l</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> model</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">trainable_variables</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        trainer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">apply_gradients</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">zip</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">grads</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> model</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">trainable_variables</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    l </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> loss</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">model</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">features</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> labels</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;epoch %d, loss: %f&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">%</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">epoch</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> l</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">epoch 1, loss: 0.519287</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">epoch 2, loss: 0.008997</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">epoch 3, loss: 0.000261</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>ä¸‹é¢æˆ‘ä»¬åˆ†åˆ«æ¯”è¾ƒå­¦åˆ°çš„æ¨¡å‹å‚æ•°å’ŒçœŸå®çš„æ¨¡å‹å‚æ•°ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡modelçš„<code>get_weights()</code>æ¥è·å¾—å…¶æƒé‡ï¼ˆ<code>weight</code>ï¼‰å’Œåå·®ï¼ˆ<code>bias</code>ï¼‰ã€‚å­¦åˆ°çš„å‚æ•°å’ŒçœŸå®çš„å‚æ•°å¾ˆæ¥è¿‘ã€‚</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">true_w</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> model</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get_weights</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">([2, -3.4], array([[ 1.9930198],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [-3.3977082]], dtype=float32))</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">true_b</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> model</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get_weights</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">(4.2, array([4.1895046], dtype=float32))</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/ch1p1/[3]linear-regression"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« <!-- -->çº¿æ€§å›å½’</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/ch1p1/[5]softmax-regression"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">softmaxå›å½’<!-- --> Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#æ‰‹åŠ¨å®ç°" class="table-of-contents__link toc-highlight">æ‰‹åŠ¨å®ç°</a><ul><li><a href="#ç”Ÿæˆæ•°æ®é›†" class="table-of-contents__link toc-highlight">ç”Ÿæˆæ•°æ®é›†</a></li><li><a href="#è¯»å–æ•°æ®" class="table-of-contents__link toc-highlight">è¯»å–æ•°æ®</a></li><li><a href="#åˆå§‹åŒ–æ¨¡å‹å‚æ•°" class="table-of-contents__link toc-highlight">åˆå§‹åŒ–æ¨¡å‹å‚æ•°</a></li><li><a href="#å®šä¹‰æ¨¡å‹" class="table-of-contents__link toc-highlight">å®šä¹‰æ¨¡å‹</a></li><li><a href="#å®šä¹‰æŸå¤±å‡½æ•°" class="table-of-contents__link toc-highlight">å®šä¹‰æŸå¤±å‡½æ•°</a></li><li><a href="#å®šä¹‰ä¼˜åŒ–ç®—æ³•" class="table-of-contents__link toc-highlight">å®šä¹‰ä¼˜åŒ–ç®—æ³•</a></li><li><a href="#è®­ç»ƒæ¨¡å‹" class="table-of-contents__link toc-highlight">è®­ç»ƒæ¨¡å‹</a></li></ul></li><li><a href="#ä½¿ç”¨æ¡†æ¶å®ç°" class="table-of-contents__link toc-highlight">ä½¿ç”¨æ¡†æ¶å®ç°</a><ul><li><a href="#ç”Ÿæˆæ•°æ®é›†-1" class="table-of-contents__link toc-highlight">ç”Ÿæˆæ•°æ®é›†</a></li><li><a href="#è¯»å–æ•°æ®-1" class="table-of-contents__link toc-highlight">è¯»å–æ•°æ®</a></li><li><a href="#å®šä¹‰æ¨¡å‹å’Œåˆå§‹åŒ–å‚æ•°" class="table-of-contents__link toc-highlight">å®šä¹‰æ¨¡å‹å’Œåˆå§‹åŒ–å‚æ•°</a></li><li><a href="#å®šä¹‰æŸå¤±å‡½æ•°-1" class="table-of-contents__link toc-highlight">å®šä¹‰æŸå¤±å‡½æ•°</a></li><li><a href="#å®šä¹‰ä¼˜åŒ–ç®—æ³•-1" class="table-of-contents__link toc-highlight">å®šä¹‰ä¼˜åŒ–ç®—æ³•</a></li><li><a href="#è®­ç»ƒæ¨¡å‹-1" class="table-of-contents__link toc-highlight">è®­ç»ƒæ¨¡å‹</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 neet-cv. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.e23c63c0.js"></script>
<script src="/assets/js/main.f6709b37.js"></script>
</body>
</html>